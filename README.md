# PEGSNet_Chile

The following scripts were generated by Andrea Licciardi

## TRAINING 
The training process requires to run the file run_train_model_torch_hotshot.py by specifying the following parameters:
`--db_name <input_database>`  where <input_database> is the name of database without the extension
`--model_outname <output_file>` where <output_file> is the desired name of the output model
for the following parameters we used the next values:
`--train_nsamp 400000` as number of samples for training
`--val_nsamp 50000` as number of samples for validation
`--test_nsamp 50000` as number of samples for testing
`--batch_size=512` as batch size
`--lr 0.001` as learning rate
`--n_epochs 100` as number of epochs
`--log_inteval 100` as interval batches 
`--ncomp 3` as number of components

## TESTING
Testing the already trained model requires to run the file run_predict_all_parallel_DDP.py by specifying the parameters:
`--model_name <output_file>_400k50k` where <output_file> is name of the model obtained in the previous step
`--data_path <input_database>.hdf5` the database on wich the model is to be tested

Files `Classes.py` and `Classes_predict.py` contain the needed functions to run `run_train_model_torch_hotshot.py` and 
`run_predict_all_parallel_DDP.py`, respectively.

The PEGSNet architecture was described in [Licciardi et al. (2022)] (https://doi.org/10.1038/s41586-022-04672-7).
